
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dem_lic.utils.lic_extended &#8212; dem_lic 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'apidocs/dem_lic/dem_lic.utils.lic_extended';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dem_lic.utils.morpho_dem" href="dem_lic.utils.morpho_dem.html" />
    <link rel="prev" title="dem_lic.utils" href="dem_lic.utils.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">dem_lic 1.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ESaint-Denis/dem_lic" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ESaint-Denis/dem_lic" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="dem_lic.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic</span></code></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="dem_lic.utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils</span></code></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils.lic_extended</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dem_lic.utils.morpho_dem.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils.morpho_dem</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="dem_lic.main_lic_extended.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.main_lic_extended</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dem_lic.cli.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.cli</span></code></a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="dem_lic.html" class="nav-link"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic</span></code></a></li>
    
    
    <li class="breadcrumb-item"><a href="dem_lic.utils.html" class="nav-link"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils</span></code></a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils.lic_extended</span></code></span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-dem_lic.utils.lic_extended">
<span id="dem-lic-utils-lic-extended"></span><h1><a class="reference internal" href="#module-dem_lic.utils.lic_extended" title="dem_lic.utils.lic_extended"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils.lic_extended</span></code></a><a class="headerlink" href="#module-dem_lic.utils.lic_extended" title="Link to this heading">#</a></h1>
<p>Groups the different stages of the processing described in the article :
“Bernhard Jenny (2021) Terrain generalization with line integral
convolution, Cartography and Geographic Information Science, 48:1, 78-92, DOI:
10.1080/15230406.2020.1833762
https://doi.org/10.1080/15230406.2020.1833762”</p>
<p>Including the preliminary processing of adaptive Gaussian blur applied to the DTM.</p>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table table-left">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dem_lic.utils.lic_extended.extended_lic_weighted_altitude_lengthModulated" title="dem_lic.utils.lic_extended.extended_lic_weighted_altitude_lengthModulated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extended_lic_weighted_altitude_lengthModulated</span></code></a></p></td>
<td><p>Applies a Line Integral Convolution (LIC) with a dynamically modulated integration
length (based on f) and a variable Gaussian kernel that reduces the influence of
higher terrain along the line of integration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dem_lic.utils.lic_extended.LIC_iterations" title="dem_lic.utils.lic_extended.LIC_iterations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LIC_iterations</span></code></a></p></td>
<td><p>Perform multiple iterations of the Line Integral Convolution (LIC) method to generalize a DEM
by combining smoothing and feature enhancement.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dem_lic.utils.lic_extended.correct_flat_area_values" title="dem_lic.utils.lic_extended.correct_flat_area_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correct_flat_area_values</span></code></a></p></td>
<td><p>Adjusts the values in flat areas of a continuous grid after Gaussian blurring
to improve the representation of transitions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dem_lic.utils.lic_extended.process_geotiff_in_block_with_overlap" title="dem_lic.utils.lic_extended.process_geotiff_in_block_with_overlap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_geotiff_in_block_with_overlap</span></code></a></p></td>
<td><p>Processes a GeoTIFF file in overlapping blocks and applies a user-defined processing function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dem_lic.utils.lic_extended.process_lic_extended" title="dem_lic.utils.lic_extended.process_lic_extended"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_lic_extended</span></code></a></p></td>
<td><p>Processes a single block of a DEM with LIC and generalization techniques.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="data">
<h3>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table table-left">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dem_lic.utils.lic_extended.lic_extended_partial" title="dem_lic.utils.lic_extended.lic_extended_partial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lic_extended_partial</span></code></a></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="api">
<h3>API<a class="headerlink" href="#api" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dem_lic.utils.lic_extended.extended_lic_weighted_altitude_lengthModulated">
<span class="sig-prename descclassname"><span class="pre">dem_lic.utils.lic_extended.</span></span><span class="sig-name descname"><span class="pre">extended_lic_weighted_altitude_lengthModulated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_range_altitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_modulated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#dem_lic.utils.lic_extended.extended_lic_weighted_altitude_lengthModulated" title="Link to this definition">#</a></dt>
<dd><p>Applies a Line Integral Convolution (LIC) with a dynamically modulated integration
length (based on f) and a variable Gaussian kernel that reduces the influence of
higher terrain along the line of integration.</p>
<p class="rubric" id="id11">Parameters</p>
<p>grid : np.ndarray
A 2D array representing the Digital Elevation Model (DEM).
local_range_altitude : np.ndarray
A 2D array (same shape as <code class="docutils literal notranslate"><span class="pre">grid</span></code>) giving the local altitude range (e.g.,
max-min in a neighborhood) for each pixel. Used to normalize the difference
in elevation along the integration line.
cellsize : float
The size of each raster cell in meters.
f : np.ndarray
A 2D array (same shape as <code class="docutils literal notranslate"><span class="pre">grid</span></code>) in [0, 1], controlling the fraction of
the maximum integration steps allowed for each pixel (e.g., in flat or steep areas).
num_steps : int
The maximum number of integration steps for each pixel.
sigma_modulated : bool, optional
If True, the sigma for the weighting in the LIC algorithm is modulated by the altitude.
If False, a fixed Gaussian sigma is used.</p>
<p class="rubric" id="id12">Returns</p>
<p>np.ndarray
The DEM after the weighted LIC processing, where ridges are accentuated
by decreasing the Gaussian kernel’s sigma for portions that lie above
the starting pixel’s altitude.</p>
<p class="rubric" id="id13">Notes</p>
<ol class="arabic simple">
<li><p>We perform two passes: forward and backward along the gradient vectors.</p></li>
<li><p>The number of steps each pixel can take in each pass is <code class="docutils literal notranslate"><span class="pre">round(f[i,j]</span> <span class="pre">*</span> <span class="pre">num_steps)</span></code>.</p></li>
<li><p>A variable Gaussian kernel is computed at each step. The difference
in altitude (dh) between the current position and the pixel’s origin
is normalized by the local altitude range, and used to reduce sigma
for higher (amont) portions.</p></li>
<li><p>The final values are normalized by the sum of the Gaussian weights.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dem_lic.utils.lic_extended.LIC_iterations">
<span class="sig-prename descclassname"><span class="pre">dem_lic.utils.lic_extended.</span></span><span class="sig-name descname"><span class="pre">LIC_iterations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_range_altitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_modulated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#dem_lic.utils.lic_extended.LIC_iterations" title="Link to this definition">#</a></dt>
<dd><p>Perform multiple iterations of the Line Integral Convolution (LIC) method to generalize a DEM
by combining smoothing and feature enhancement.</p>
<p class="rubric" id="id14">Parameters</p>
<p>grid : numpy.ndarray
2D array representing the input Digital Elevation Model (DEM).
local_range_altitude : numpy ndarray
2D array of the range of elevation in a windows centered on each point
cellsize : float
The spatial resolution of the DEM (in meters).
f : numpy.ndarray
Continuous grid used to modulate the integration length.
num_steps : int
Maximum length of the integration line.
sigma_modulated : bool, optional
If True, the sigma for the weighting in the LIC algorithm is modulated by the altitude.
If False, a fixed Gaussian sigma is used.
n_iterations : int
Number of iterations of the LIC algorithm.
sigma : float
Standard deviation for the Gaussian blur applied to the curvature.
k : float
Weighting factor for the combination of grids.</p>
<p class="rubric" id="id15">Returns</p>
<p>numpy.ndarray
2D array representing the DEM after LIC iterations.</p>
<p class="rubric" id="id16">Notes</p>
<p>This function performs the following steps for each iteration:</p>
<ol class="arabic simple">
<li><p>Computes a modulated LIC</p></li>
<li><p>Calculates the maximal curvature of the resulting grid.</p></li>
<li><p>Applies Gaussian smoothing to the curvature.</p></li>
<li><p>Updates the DEM using a weighted combination of the original DEM and the LIC result.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dem_lic.utils.lic_extended.correct_flat_area_values">
<span class="sig-prename descclassname"><span class="pre">dem_lic.utils.lic_extended.</span></span><span class="sig-name descname"><span class="pre">correct_flat_area_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#dem_lic.utils.lic_extended.correct_flat_area_values" title="Link to this definition">#</a></dt>
<dd><p>Adjusts the values in flat areas of a continuous grid after Gaussian blurring
to improve the representation of transitions.</p>
<p class="rubric" id="id17">Parameters</p>
<p>b : numpy.ndarray
2D binary array representing flat areas (0) and steep areas (1).
c : numpy.ndarray
2D continuous array, the result of applying Gaussian blur to the binary grid.
sigma : float
Gaussian blur parameter for processing the differences.
epsilon : float, optional
A small value to avoid division by zero, by default 1e-6.</p>
<p class="rubric" id="id18">Returns</p>
<p>numpy.ndarray
2D corrected array after adjusting values in flat areas.</p>
<p class="rubric" id="id19">Notes</p>
<p>The function modifies the continuous grid <code class="docutils literal notranslate"><span class="pre">c</span></code> by correcting values in flat areas (indicated by 0 in <code class="docutils literal notranslate"><span class="pre">b</span></code>).
The adjustment is based on a blurred version of the difference between <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>, scaled by a
computed factor <code class="docutils literal notranslate"><span class="pre">s</span></code>. This ensures smoother transitions while preserving flat and steep area characteristics.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dem_lic.utils.lic_extended.process_geotiff_in_block_with_overlap">
<span class="sig-prename descclassname"><span class="pre">dem_lic.utils.lic_extended.</span></span><span class="sig-name descname"><span class="pre">process_geotiff_in_block_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MNT_input_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processing_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dem_lic.utils.lic_extended.process_geotiff_in_block_with_overlap" title="Link to this definition">#</a></dt>
<dd><p>Processes a GeoTIFF file in overlapping blocks and applies a user-defined processing function.</p>
<p class="rubric" id="id20">Parameters</p>
<p>MNT_input_path : str
Path to the input GeoTIFF file containing the Digital Elevation Model (DEM).
output_path : str
Path to the output GeoTIFF file.
processing_function : function
A function that processes a single block. It should accept a block (ndarray), cell size,
and any additional parameters.
block_size : int, optional
Size of non-overlapping blocks (in pixels) to process. Default is 2000.
overlap : int, optional
Size of the overlapping region (in pixels) between adjacent blocks. Default is 20.
**kwargs
Additional arguments passed to <code class="docutils literal notranslate"><span class="pre">processing_function</span></code>.</p>
<p class="rubric" id="id21">Returns</p>
<p>None
The processed output is written directly to the specified GeoTIFF file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dem_lic.utils.lic_extended.process_lic_extended">
<span class="sig-prename descclassname"><span class="pre">dem_lic.utils.lic_extended.</span></span><span class="sig-name descname"><span class="pre">process_lic_extended</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MNT_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_modulated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_blur_maxcurv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#dem_lic.utils.lic_extended.process_lic_extended" title="Link to this definition">#</a></dt>
<dd><p>Processes a single block of a DEM with LIC and generalization techniques.</p>
<p class="rubric" id="id22">Parameters</p>
<p>MNT_block : np.ndarray
The block of the Digital Elevation Model.
cellsize : float
Size of the raster cells in meters.
sigma_max : float
Maximum kernel width for the adaptive Gaussian blur.
slope_threshold : float
Threshold for slope to distinguish flat and steep areas.
num_bins : int
Number of bins for sigma approximation in the adaptive blur.
min_area : int
Minimum size (in pixels) for flat areas to be preserved.
num_steps : int
Maximum integration length for the LIC algorithm.
sigma_modulated : bool
If True, sigma is modulated by altitude in LIC processing.
n_iterations : int
Number of iterations for the LIC algorithm.
sigma_blur_maxcurv : float
Gaussian blur parameter for maximum curvature.
k : float
Weighting factor for combining LIC grids.</p>
<p class="rubric" id="id23">Returns</p>
<p>np.ndarray
Processed DEM block.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="dem_lic.utils.lic_extended.lic_extended_partial">
<span class="sig-prename descclassname"><span class="pre">dem_lic.utils.lic_extended.</span></span><span class="sig-name descname"><span class="pre">lic_extended_partial</span></span><a class="headerlink" href="#dem_lic.utils.lic_extended.lic_extended_partial" title="Link to this definition">#</a></dt>
<dd><p>‘partial(…)’</p>
</dd></dl>

</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dem_lic.utils.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="dem_lic.utils.morpho_dem.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dem_lic.utils.morpho_dem</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api">API</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dem_lic.utils.lic_extended.extended_lic_weighted_altitude_lengthModulated"><code class="docutils literal notranslate"><span class="pre">extended_lic_weighted_altitude_lengthModulated()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dem_lic.utils.lic_extended.LIC_iterations"><code class="docutils literal notranslate"><span class="pre">LIC_iterations()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dem_lic.utils.lic_extended.correct_flat_area_values"><code class="docutils literal notranslate"><span class="pre">correct_flat_area_values()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dem_lic.utils.lic_extended.process_geotiff_in_block_with_overlap"><code class="docutils literal notranslate"><span class="pre">process_geotiff_in_block_with_overlap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dem_lic.utils.lic_extended.process_lic_extended"><code class="docutils literal notranslate"><span class="pre">process_lic_extended()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dem_lic.utils.lic_extended.lic_extended_partial"><code class="docutils literal notranslate"><span class="pre">lic_extended_partial</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/apidocs/dem_lic/dem_lic.utils.lic_extended.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Edmond SAINT DENIS.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>